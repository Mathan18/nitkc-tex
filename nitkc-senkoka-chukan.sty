\NeedsTeXFormat{pLaTeX2e}
\ProvidesPackage{nitkc-senkoka-chukan}

% \sectionのフォーマット変更
% コードはsecdot.styのものを流用
% issue: 冒頭に書かないと動作しない（原因不明）
\newcommand\sectiondot[1]{%
  \expandafter\def\csname @seccntfmt@#1\endcsname##1{%
    \csname the##1\endcsname \hskip 1sp
  }
}
\sectiondot{section}
\renewcommand\@seccntformat[1]{\@ifundefined{@seccntfmt@#1}%
  {\csname the#1\endcsname\quad}% original default style
  {\csname @seccntfmt@#1\endcsname{#1}}%
}

% フォントサイズ指定，行送りの値は適当
\newcommand{\FontsizeTitle}{\jsc@setfontsize{\FontsizeTitle}{15}{30}}
\newcommand{\FontsizeAuthor}{\jsc@setfontsize{\FontsizeAuthor}{10}{14}}
\newcommand{\FontsizeAffiliate}{\jsc@setfontsize{\FontsizeAffiliate}{9}{13}}
\newcommand{\FontsizeKeywords}{\jsc@setfontsize{\FontsizeKeywords}{9}{13}}
\newcommand{\FontsizeSection}{\jsc@setfontsize{\FontsizeAffiliate}{11}{14}}
\newcommand{\FontsizeText}{\jsc@setfontsize{\FontsizeAffiliate}{10}{14}}

% 和文はイタリックの代わりにオブリークを使う
\def\jptextit#1{\makebox[5zw][l]{\vphantom{#1}\rotatebox{-48.8}{\scalebox{0.875}[1.143]{\rotatebox{41.2}{\smash{\rlap{#1}}}}}}}

% フォントスタイルの定義
\newcommand{\TitleFont}{\FontsizeTitle\gtfamily\bfseries\userelfont\selectfont}
\newcommand{\AuthorFont}{\FontsizeAuthor\mcfamily\mdseries\userelfont\selectfont}
\newcommand{\AffiliateFont}{\FontsizeAffiliate\mcfamily\mdseries\userelfont\selectfont}
\newcommand{\KeywordsTitleFont}{\FontsizeKeywords\mcfamily\bfseries\userelfont\selectfont}
\newcommand{\KeywordsFont}{\FontsizeKeywords\mcfamily\mdseries\userelfont\selectfont}
\newcommand{\SectionFont}{\FontsizeSection\gtfamily\mdseries\userelfont\selectfont}
\newcommand{\TextFont}{\FontsizeText\mcfamily\mdseries\userelfont\selectfont}

% 研究室名，キーワード受け取り
\def\affiliate#1{\gdef\@affiliate{#1}}\def\@affiliate{}
\def\keywords#1{\gdef\@keywords{#1}}\def\@keywords{}

% タイトル部のフォーマット変更，本文の2段組指定
\renewcommand{\maketitle}{
    \twocolumn[
        \begin{center}
            {\TitleFont \@title} \\
            \vskip 10\jsc@mpt
            {\AuthorFont {\@author}*} \\
            {\AffiliateFont \@affiliate} \\
            \vskip 10\jsc@mpt
            {{\KeywordsTitleFont \jptextit{キーワード}}{\KeywordsFont~:~\@keywords}} \\
        \end{center}
    ]
}

% \sectionの見出しのフォーマット変更
\makeatletter
\renewcommand{\section}{
    \@startsection{section}{1}
    {1sp}% 見出し左の空き
    {1.5\Cvs \@plus.5\Cvs \@minus.2\Cvs}% 見出し上の空き
    {.5\Cvs \@plus.3\Cvs}% 見出し下の空き
    {\centering \SectionFont}% 中央揃え，フォント変更
}
\makeatother

% \sectionの数字を全角に変更，ピリオドの規定
\makeatletter
\def\@arabicz#1{%
  \ifcase#1 ０\or １\or ２\or ３\or ４\or ５\or ６\or ７\or ８\or ９\or １０\else\@ctrerr\fi}
\def\arabicz#1{\expandafter\@arabicz\csname c@#1\endcsname}
\renewcommand{\thesection}{\SectionFont \@arabicz\c@section．}
\makeatother

% \subsectionの見出しのフォーマット変更
\makeatletter
\renewcommand{\subsection}{
    \@startsection{subsection}{2}
    {11pt}% 見出し左の空き
    {1.5\Cvs \@plus.5\Cvs \@minus.2\Cvs}% 見出し上の空き
    {.5\Cvs \@plus.3\Cvs}% 見出し下の空き
    {\SectionFont}% 中央揃え，フォント変更
}
\makeatother

% \subsectionの数字をゴシック体に変更
\makeatletter
\renewcommand{\thesubsection}{\SectionFont \@arabic\c@section.\@arabic\c@subsection}
\makeatother

\endinput
